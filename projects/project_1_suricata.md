Project 1: Implementing and Testing a SurProject 1: Implementing and Testing a Suricata-based IDS/IPS
üí° Objective
The primary objective of this project was to gain hands-on experience deploying, configuring, and testing an Intrusion Detection/Prevention System (IDS/IPS) in a simulated network. I aimed to prove my ability to use Suricata to monitor and actively block malicious network traffic.

üõ†Ô∏è Tools & Environment
Virtualization: VMware Workstation

Logical Topology: A simple network with an attacker machine (Kali Linux), a vulnerable target (Metasploitable 2), and a Suricata host (Ubuntu Server). All machines were configured to communicate over an isolated internal network.

Operating Systems: Ubuntu Server (for Suricata), Kali Linux (Attacker), Metasploitable 2 (Victim)

Key Tools:

Suricata: The primary IDS/IPS engine.

Wireshark: Used for independent traffic verification.

Nmap: Used as a simulated attack vector.

‚öôÔ∏è Step-by-Step Process
1. Initial Lab Setup
I began by creating and configuring the virtual machines and establishing a dedicated virtual network. This ensured that all traffic, including simulated attacks, was contained within the lab environment and did not affect my host machine or external network.

2. IDS Mode: Detection & Analysis
I installed Suricata on the Ubuntu server. Before running it, I edited the suricata.yaml configuration file to define the network ranges and logging paths. I then ran Suricata in a detection-only mode using the following command to monitor the network interface:

sudo suricata -c /etc/suricata/suricata.yaml -i <your_network_interface>

To test the setup, I executed a standard Nmap scan from the Kali Linux machine against the Metasploitable 2 target. I then analyzed the eve.json log file generated by Suricata, which successfully captured and alerted on the Nmap scan, validating that the system was correctly identifying suspicious activity.

3. IPS Mode: Prevention & Blocking
To transition to prevention mode, I modified the iptables on the Ubuntu server to forward packets to the Suricata queue for inspection using NFQUEUE. This setup allowed Suricata to process and make decisions on traffic before it reached the destination.

Next, I updated the suricata.yaml file to enable IPS mode and modified the default action for specific rules to drop. I restarted Suricata and re-ran the Nmap scan from the Kali machine. The traffic was successfully dropped, and I verified that the scan failed to complete. I also confirmed that Suricata logged a "blocked" event in the eve.json file.

üß† Challenges & Lessons Learned
Troubleshooting Network Interfaces: My initial attempt failed because Suricata wasn't detecting any traffic. I spent time troubleshooting by using ifconfig to confirm the correct interface name and inspecting the suricata.yaml configuration to ensure the interface was correctly mapped. This reinforced the importance of meticulous configuration and the value of fundamental networking knowledge.

Understanding Rule Management: I learned how to work with rule sets and how to strategically enable or disable rules to fine-tune the detection process. This is a critical skill for managing noisy or overly-aggressive security systems in a real-world environment.

Conclusion

This project was a foundational exercise in defensive security. It provided me with practical, hands-on experience in configuring and operating a crucial network security tool. I'm now confident in my ability to implement, test, and troubleshoot an IDS/IPS, a core competency for any aspiring cybersecurity analyst.
